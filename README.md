# CryptoTool 桌面加密工具

这是一个功能完整的桌面加密工具，支持RSA和SM4国密算法的各种加密、解密、签名和验签操作。

## 功能特性

### RSA算法支持
- **密钥生成**: 支持1024、2048、3072、4096位密钥长度
- **密钥格式**: 支持PKCS1、PKCS8类型格式
- **加密解密**: 使用RSA公钥加密、私钥解密
- **数字签名**: 支持多种签名算法，常用的有RSA(SHA1)和RSA2(SHA256)两种
- **验签功能**: 验证RSA数字签名的有效性

### SM4国密算法支持
- **密钥生成**: 自动生成128位SM4密钥和初始向量
- **加密模式**: 支持ECB和CBC两种加密模式
- **填充模式**: 支持PKCS7、PKCS5、NoPadding三种填充模式
- **加密解密**: 完整的SM4对称加密解密功能

## 界面说明

### RSA算法选项卡

#### 密钥生成区域
- **密钥长度**: 选择RSA密钥的位数（1024/2048/3072/4096）
- **密钥格式**: 选择密钥的输出格式
  - **PKCS1**: PEM编码的传统RSA格式
  - **PKCS8**: PEM编码的现代标准格式
- **生成密钥对**: 点击生成公私钥对

#### 加密解密区域
- **明文**: 输入要加密的文本
- **密文**: 显示加密后的Base64编码结果
- **加密**: 使用公钥对明文进行加密
- **解密**: 使用私钥对密文进行解密

#### 数字签名区域
- **签名类型**: 
  - **RSA**: 使用SHA1哈希算法
  - **RSA2**: 使用SHA256哈希算法（推荐）
- **原文数据**: 输入要签名的原始文本
- **签名**: 显示生成的数字签名
- **签名**: 使用私钥对原文进行签名
- **验签**: 使用公钥验证签名的有效性
- **验签结果**: 显示验签是否成功

### SM4算法选项卡

#### 密钥生成区域
- **SM4密钥**: 显示生成的Base64编码的128位密钥
- **初始向量**: CBC模式需要的初始向量
- **生成密钥**: 生成随机的SM4密钥
- **生成向量**: 生成随机的初始向量

#### 加密解密区域
- **加密模式**: 
  - **ECB**: 电子码本模式（不需要初始向量）
  - **CBC**: 密码分组链接模式（需要初始向量）
- **填充模式**: 
  - **PKCS7**: 标准填充模式（推荐）
  - **PKCS5**: PKCS5填充（在SM4中等同于PKCS7）
  - **NoPadding**: 无填充（数据长度必须是16字节的整数倍）
- **明文**: 输入要加密的文本
- **密文**: 显示加密后的Base64编码结果
- **加密**: 对明文进行SM4加密
- **解密**: 对密文进行SM4解密

## 使用指南

### RSA操作流程

1. **生成密钥对**:
   - 选择合适的密钥长度（建议2048位或更高）
   - 选择密钥格式（一般情况下选XML格式即可）
   - 点击"生成密钥对"按钮

2. **加密操作**:
   - 在明文框中输入要加密的内容
   - 确保公钥框中有有效的公钥
   - 点击"加密"按钮，密文将显示在密文框中

3. **解密操作**:
   - 在密文框中输入要解密的Base64编码内容
   - 确保私钥框中有对应的私钥
   - 点击"解密"按钮，明文将显示在明文框中

4. **签名操作**:
   - 选择签名类型（推荐RSA2）
   - 在原文数据框中输入要签名的内容
   - 确保私钥框中有有效的私钥
   - 点击"签名"按钮，签名将显示在签名框中

5. **验签操作**:
   - 确保原文数据、签名和公钥都已正确输入
   - 点击"验签"按钮，结果会显示在验签结果标签中

### SM4操作流程

1. **生成密钥**:
   - 点击"生成密钥"按钮生成SM4密钥
   - 如果使用CBC模式，点击"生成向量"按钮生成初始向量

2. **设置参数**:
   - 选择加密模式（ECB或CBC）
   - 选择填充模式（一般选择PKCS7）
   - ECB模式不需要初始向量，CBC模式需要

3. **加密操作**:
   - 在明文框中输入要加密的内容
   - 确保密钥已生成
   - 如果是CBC模式，确保初始向量已生成
   - 点击"加密"按钮

4. **解密操作**:
   - 在密文框中输入要解密的Base64编码内容
   - 使用相同的密钥、模式和填充设置
   - 点击"解密"按钮

## 注意事项

### RSA算法
- RSA加密有长度限制，对于2048位密钥，最多只能加密245字节的数据
- 数字签名推荐使用RSA2算法（SHA256）
- 保管好私钥，公钥可以公开分享
- 不同格式的密钥不能混用，请确保格式一致

### SM4算法
- SM4密钥长度固定为128位（16字节）
- CBC模式需要初始向量，且每次加密应使用不同的初始向量
- 无填充模式要求数据长度必须是16字节的整数倍
- SM4是对称加密算法，加密解密使用同一密钥

### 通用提示
- Base64编码的数据在复制粘贴时注意不要包含额外的空格或换行符
- 大量数据处理时可能需要等待，请耐心等候
- 遇到错误时，错误信息会通过弹窗显示，请仔细阅读错误提示
- 状态栏会显示当前操作的进度和结果

## 技术说明

本工具基于以下技术和库构建：
- **.NET 8**: 现代化的.NET平台
- **Windows Forms**: 经典的桌面UI框架
- **BouncyCastle**: 提供完整的加密算法实现
- **CryptoTool.Common**: 封装的加密工具库

支持的操作系统：
- Windows 10/11 (.NET 8 Runtime)

## 安全建议

1. **密钥管理**: 
   - 妥善保管私钥，不要泄露给第三方
   - 定期更换密钥，特别是在怀疑密钥泄露时
   - 使用足够长度的密钥（RSA建议2048位以上）

2. **使用场景**:
   - 不要在生产环境中直接使用此工具处理敏感数据
   - 建议仅用于学习、测试和开发目的
   - 重要数据请使用专业的加密解决方案

3. **网络安全**:
   - 在不安全的网络环境中不要传输私钥
   - 使用安全的通道传输加密后的数据
   - 定期更新和检查加密算法的安全性

## 参考链接

[【开源】全网首个支持国密算法的微信支付 C#/.NET SDK（附 SM2/SM3/SM4 跨语言联调的踩坑要点）](https://developers.weixin.qq.com/community/develop/article/doc/000a60d64bcc48a17feeff8e95b813)
[C#.NET 国密SM4对称加解密 与JAVA互通](https://www.cnblogs.com/runliuv/p/17593661.html)
[国密（国产密码）SM2、SM3、SM4 C#实现 ](https://www.cnblogs.com/guanshan/p/guan2022-5-5_002.html)
